!function(e,t){function n(){var n=e._page_type?e._page_type:0,o=e._tt_config,r={FAIL:0,UNUSE:1,SUCCESS:2},i="",a="",s=20,c=null,d="",u="",g="",f="",l="",p="",_="",v="",m="",h="",S=r.UNUSE,y=r.UNUSE,w={combineData:function(){for(var e={},t=Array.prototype.slice.call(arguments),n=0;n<t.length;n++)for(var o in t[n])e[o]&&t[n][o]&&(e[o]=t[n][o]),e[o]||void 0===t[n][o]||null===t[n][o]||(e[o]=t[n][o]);return e},getOS:function(){var e=navigator.userAgent,t={android:e.match(/(Android)\s+([\d.]+)/),ipad:e.match(/(iPad).*OS\s([\d_]+)/),iphone:e.match(/(iPhone\sOS)\s([\d_]+)/)},n="";return t.android?n="android":(t.ipad||t.iphone)&&(n="ios"),n},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isToutiao:function(){var e="http://nativeapp.toutiao.com"==document.referrer||/(News|NewsSocial|Explore|NewsArticle|NewsInHouse|joke_essay|Joke|Video|VideoInHouse|VideoArticle|live_stream)(\s|\/|_)(\S)/i.test(navigator.userAgent);return e},isLive:function(){return/(live_stream)(\s|\/|_)(\S)/i.test(navigator.userAgent)},isJoke:function(){return/(joke_essay|Joke)(\s|\/|_)(\S)/i.test(navigator.userAgent)},getDefer:function(){var e={},t=new Promise(function(t,n){e.resolve=t,e.reject=n});return e.promise=t,e},getLocationParam:function(e){var t={QueryString:function(e){var t=window.location.href,n=new RegExp("[&?]{1}"+e+"=([^&?|^#?]*)","ig");return t.match(n)?decodeURI(t.match(n)[0].substr(e.length+2)):(t=document.referrer,t.match(n)?decodeURI(t.match(n)[0].substr(e.length+2)):"")}};return t.QueryString(e)},queryToJson:function(e){for(var t,n,o,r,i=e.substr(e.lastIndexOf("?")+1),a=i.split("&"),s=a.length,c={},d=0;s>d;d++)a[d]&&(r=a[d].split("="),t=r[0],n=r[1],o=c[t],"undefined"==typeof o?c[t]=n:this.isArray(o)?o.push(n):c[t]=[o,n]);return c},jsonToQuery:function(e){var t=[];e=e||{};var n=/^(?:string|boolean|number)/i;for(var o in e)e.hasOwnProperty(o)&&n.test(typeof e[o])&&t.push(o+"="+e[o]);return t.join("&")},extend:function(e,t){for(var n in t)e[n]=t[n]},getAdId:function(){var e=w.getLocationParam("_tt_ad_id")||w.getLocationParam("ad_id")||w.getLocationParam("aid");return e},getReqId:function(){return w.getLocationParam("req_id")||""},getCid:function(){return w.getLocationParam("cid")||""},getWebUrlInfo:function(){var e,t=window.decodeURIComponent(w.getLocationParam("_toutiao_params")||"");try{e=JSON.parse(t)}catch(n){}return e},encodeParams:function(e){var t=[];e=e||{};var n=/^(?:string|boolean|number)/i;for(var o in e)if(e.hasOwnProperty(o)&&n.test(typeof e[o])){var r=decodeURIComponent(e[o]);t.push(encodeURIComponent(o)+"="+encodeURIComponent(r))}return t.join("&")},jsonp:function(e){if(e=e||{},!e.url||!e.callback)throw new Error("参数不合法");var t=("jsonp_"+Math.random()).replace(".",""),n=document.getElementsByTagName("head")[0];e.data[e.callback]=t;var o=this.encodeParams(e.data),r=document.createElement("script");n.appendChild(r),window[t]=function(o){n.removeChild(r),clearTimeout(r.timer),window[t]=null,e.success&&e.success(o)},r.src=e.url+"?"+o,e.time&&(r.timer=setTimeout(function(){window[t]=null,n.removeChild(r),e.fail&&e.fail({message:"超时"})},e.time))},syncGet:function(e){var t=new XMLHttpRequest;t.open("GET",e.url,!1),t.withCredentials=!0,t.send(null)},imageGet:function(e){var t=new Image;t.src=window.location.protocol+e.url},addLoadEvent:function(e){var t=window.onload;window.onload="function"!=typeof window.onload?e:function(){t(),e()}},getSiteId:function(){var e=window.location.pathname,t=/\d+/g,n=e.match(t)||[];return n[0]||""},setToSessionStorage:function(e,t){var n=window.sessionStorage;n.setItem(e,t)},getFromSessionStorage:function(e){var t=window.sessionStorage;return t.getItem(e)},_parseUmengData:function(t){var o={value:v||w.getCid()},r=o.extra={site_id:h,options:{},log_extra:c||"{}",convert_id:m||0};for(var i in t)if("target"===i)w.extend(r,this._getPosition(t[i]));else if("page_url"===i)r[i]=decodeURIComponent(t[i])||decodeURIComponent(e.location.href);else if("page_type"===i)r[i]=t[i]||n;else if("track_data"===i){var s=JSON.parse(e.decodeURIComponent(t[i])),d=["page_url","page_type","event_type","event_value","xpath","os"];d.forEach(function(e){var t=s[0][e];r[e]=t||0===t?t:""})}else r[i]=t[i];try{r.options=JSON.parse(t.options||"{}")}catch(u){r.options.other=t.options}return r.options=JSON.stringify(r.options),"xpath"===t.event_type&&(r.dom_md5=a),r.log_extra=c||"{}",r.tt_bridge=100+10*S+y,o},_sendUmengEvent:function(e,t,n){var o="android"===w.getOS(),r="";r=w.isJoke()||o||w.isLive()?"log_event":"custom_event";var i="bytedance://"+r+"?category=umeng&tag="+e+"&label="+t;if(n)for(var a in n){var s=n[a];if("extra"===a&&"object"==typeof s)if(o)i+="&extra="+encodeURIComponent(JSON.stringify(s));else{var c=s,d="";for(var u in c)d+="object"==typeof c[u]?"&"+u+"="+encodeURIComponent(JSON.stringify(c[u])):"&"+u+"="+encodeURIComponent(c[u]);i+=d}else i+="&"+a+"="+encodeURIComponent(s)}try{window.webkit.messageHandlers.observe.postMessage(i)}catch(g){console.log(i)}}},I={getChildrenIndex:function(e){if(e.sourceIndex)return e.sourceIndex-e.parentNode.sourceIndex-1;for(var t=0;e=e.previousElementSibling;)t++;return t},getXPath:function(e){for(var t="";e.length;){var n=Array.prototype.pop.apply(e);if(n&&n.tagName&&"body"!=n.tagName.toLowerCase()&&"html"!=n.tagName.toLowerCase()){var o="function"==typeof n.getAttribute?n.getAttribute("id"):"";t+=n.tagName.toLowerCase()+this.getChildrenIndex(n)+(o?"#"+o:"")+(0==e.length?"":">")}}return t},getElementByAttr:function(e,t){if("string"==typeof e&&(e=document.getElementById(e)),e||(e=document),e.querySelectorAll){var n=e.querySelectorAll("["+t+"]");return n=Array.prototype.slice.call(n)}for(var o=e.getElementsByTagName("*"),r=o.length,i=0,a=[];r>i;i++){var s=o[i];s.getAttribute(t)&&a.push(s)}return a},getPerformanceObj:function(){if(!window.performance)return"";var e=performance.timing;return e},getDomCount:function(){return document.getElementsByTagName("*").length},getElementParentsAndSelf:function(e){var t=this.getElementParents(e);return t.unshift(e),t},getElementParents:function(e){for(var t=[];e;)e=e.parentNode,e&&t.push(e);return t},delegate:function(e,t,n,o){function r(t){var r=/^\[(.*)\]$/,a=window.event?window.event:t,s=a.target||a.srcElement;if(r.test(n))for(var c=n.match(r)[1],d=I.getElementByAttr(e,c),u=s;u;){if(i.inElement(u,d)){o.call(s,a);break}u=u.parentNode}}if("string"==typeof e&&(e=document.getElementById(e)),e||(e=document),n&&"function"==typeof o){var i=this;e[t]=r}},inElement:function(e,t){for(var n=t.length,o=0;n>o;o++)if(e==t[o])return!0;return!1}};!function(e){"use strict";function t(e,t){var n=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(n>>16);return o<<16|65535&n}function n(e,t){return e<<t|e>>>32-t}function o(e,o,r,i,a,s){return t(n(t(t(o,e),t(i,s)),a),r)}function r(e,t,n,r,i,a,s){return o(t&n|~t&r,e,t,i,a,s)}function i(e,t,n,r,i,a,s){return o(t&r|n&~r,e,t,i,a,s)}function a(e,t,n,r,i,a,s){return o(t^n^r,e,t,i,a,s)}function s(e,t,n,r,i,a,s){return o(n^(t|~r),e,t,i,a,s)}function c(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var o,c,d,u,g,f=1732584193,l=-271733879,p=-1732584194,_=271733878;for(o=0;o<e.length;o+=16)c=f,d=l,u=p,g=_,f=r(f,l,p,_,e[o],7,-680876936),_=r(_,f,l,p,e[o+1],12,-389564586),p=r(p,_,f,l,e[o+2],17,606105819),l=r(l,p,_,f,e[o+3],22,-1044525330),f=r(f,l,p,_,e[o+4],7,-176418897),_=r(_,f,l,p,e[o+5],12,1200080426),p=r(p,_,f,l,e[o+6],17,-1473231341),l=r(l,p,_,f,e[o+7],22,-45705983),f=r(f,l,p,_,e[o+8],7,1770035416),_=r(_,f,l,p,e[o+9],12,-1958414417),p=r(p,_,f,l,e[o+10],17,-42063),l=r(l,p,_,f,e[o+11],22,-1990404162),f=r(f,l,p,_,e[o+12],7,1804603682),_=r(_,f,l,p,e[o+13],12,-40341101),p=r(p,_,f,l,e[o+14],17,-1502002290),l=r(l,p,_,f,e[o+15],22,1236535329),f=i(f,l,p,_,e[o+1],5,-165796510),_=i(_,f,l,p,e[o+6],9,-1069501632),p=i(p,_,f,l,e[o+11],14,643717713),l=i(l,p,_,f,e[o],20,-373897302),f=i(f,l,p,_,e[o+5],5,-701558691),_=i(_,f,l,p,e[o+10],9,38016083),p=i(p,_,f,l,e[o+15],14,-660478335),l=i(l,p,_,f,e[o+4],20,-405537848),f=i(f,l,p,_,e[o+9],5,568446438),_=i(_,f,l,p,e[o+14],9,-1019803690),p=i(p,_,f,l,e[o+3],14,-187363961),l=i(l,p,_,f,e[o+8],20,1163531501),f=i(f,l,p,_,e[o+13],5,-1444681467),_=i(_,f,l,p,e[o+2],9,-51403784),p=i(p,_,f,l,e[o+7],14,1735328473),l=i(l,p,_,f,e[o+12],20,-1926607734),f=a(f,l,p,_,e[o+5],4,-378558),_=a(_,f,l,p,e[o+8],11,-2022574463),p=a(p,_,f,l,e[o+11],16,1839030562),l=a(l,p,_,f,e[o+14],23,-35309556),f=a(f,l,p,_,e[o+1],4,-1530992060),_=a(_,f,l,p,e[o+4],11,1272893353),p=a(p,_,f,l,e[o+7],16,-155497632),l=a(l,p,_,f,e[o+10],23,-1094730640),f=a(f,l,p,_,e[o+13],4,681279174),_=a(_,f,l,p,e[o],11,-358537222),p=a(p,_,f,l,e[o+3],16,-722521979),l=a(l,p,_,f,e[o+6],23,76029189),f=a(f,l,p,_,e[o+9],4,-640364487),_=a(_,f,l,p,e[o+12],11,-421815835),p=a(p,_,f,l,e[o+15],16,530742520),l=a(l,p,_,f,e[o+2],23,-995338651),f=s(f,l,p,_,e[o],6,-198630844),_=s(_,f,l,p,e[o+7],10,1126891415),p=s(p,_,f,l,e[o+14],15,-1416354905),l=s(l,p,_,f,e[o+5],21,-57434055),f=s(f,l,p,_,e[o+12],6,1700485571),_=s(_,f,l,p,e[o+3],10,-1894986606),p=s(p,_,f,l,e[o+10],15,-1051523),l=s(l,p,_,f,e[o+1],21,-2054922799),f=s(f,l,p,_,e[o+8],6,1873313359),_=s(_,f,l,p,e[o+15],10,-30611744),p=s(p,_,f,l,e[o+6],15,-1560198380),l=s(l,p,_,f,e[o+13],21,1309151649),f=s(f,l,p,_,e[o+4],6,-145523070),_=s(_,f,l,p,e[o+11],10,-1120210379),p=s(p,_,f,l,e[o+2],15,718787259),l=s(l,p,_,f,e[o+9],21,-343485551),f=t(f,c),l=t(l,d),p=t(p,u),_=t(_,g);return[f,l,p,_]}function d(e){var t,n="",o=32*e.length;for(t=0;o>t;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function u(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var o=8*e.length;for(t=0;o>t;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function g(e){return d(c(u(e),8*e.length))}function f(e,t){var n,o,r=u(e),i=[],a=[];for(i[15]=a[15]=void 0,r.length>16&&(r=c(r,8*e.length)),n=0;16>n;n+=1)i[n]=909522486^r[n],a[n]=1549556828^r[n];return o=c(i.concat(u(t)),512+8*t.length),d(c(a.concat(o),640))}function l(e){var t,n,o="0123456789abcdef",r="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),r+=o.charAt(t>>>4&15)+o.charAt(15&t);return r}function p(e){return unescape(encodeURIComponent(e))}function _(e){return g(p(e))}function v(e){return l(_(e))}function m(e,t){return f(p(e),p(t))}function h(e,t){return l(m(e,t))}function S(e,t,n){return t?n?m(t,e):h(t,e):n?_(e):v(e)}e.md5=S}(this);var b={getPrefix:function(e){var t="";try{t=e.split("_")[0]}catch(n){}return t},traversal:function(e,t,n,o,r){if(e&&1===e.nodeType&&!(n>=o)){var i="",a=this.getPrefix(t);r(t);for(var s,c=0,d=e.childNodes,u=0;c<d.length;c++)s=d[c],s&&1===s.nodeType&&(i=a+","+u+"_"+s.tagName,this.traversal(s,i,n+1,o,r),++u)}}};h=n?w.getSiteId():"",e._taq={push:function(e){var t={};return e.event_type?(e.convert_id&&(m=e.convert_id),t=this._assembleData(e),void this._send_log(t)):void console.log("event_type is null")},get_query:function(e){var t={};return e.event_type?t=this._assembleData(e):void console.log("event_type is null")},getFromTTBridge:function(e,t){"adInfo"==e?S=r.FAIL:"appInfo"==e&&(y=r.FAIL),"function"==typeof ToutiaoJSBridge.call&&ToutiaoJSBridge.call(e,{},function(n){"adInfo"==e?S=r.SUCCESS:"appInfo"==e&&(y=r.SUCCESS),t(n)})},_send_log:function(e){if(w.isToutiao()){var t=w._parseUmengData(e);return void w._sendUmengEvent("embeded_ad","convert",t)}var o={out:"//isub.snssdk.com/2/wap/landing_tetris_log/","in":"//ad.toutiao.com/tetris/landing/log/"},r=n?o.in:o.out;e.source="webunion",r+="?"+w.jsonToQuery(e);try{w.syncGet({url:r})}catch(i){}},_assembleData:function(t){var o={},r={},i={},s="",d=this;for(var u in t)if("target"==u){var g=d._getPosition(t[u]);w.extend(o,g)}else o[u]=t[u];try{r=JSON.parse(t.options||"{}")}catch(f){console.log("options 必须为JSON格式字符串"),r.other=t.options}return"performance"===t.event_type&&(r.performance=I.getPerformanceObj()),"xpath"===t.event_type&&(r.dom_md5=a),o.options=r,o.log_extra=c||"{}",o.os=w.getOS(),o.page_url=decodeURIComponent(e.location.href),o.page_type=o.page_type||n,w.extend(i,d._getDeviceInfo()),w.extend(i,d._getPageInfo()),s=window.encodeURIComponent(JSON.stringify([o])),w.extend(i,{track_data:s}),i.tt_bridge=100+10*S+y,i.app_id=_,i},_getPageInfo:function(){var e={};return e.req_id=d||w.getReqId(),e.cid=v||w.getCid(),e.site_id=h,e.ad_id=w.getAdId(),e},_getDeviceInfo:function(){var e={};return e.device_id=u,e.user_id=g,e.uid=f,e.ut=l,e.client_version=p,e},_getPosition:function(n){if(n){var o=e.innerWidth||t.body.clientWidth,r=n.offsetLeft,i=n.offsetHeight,a=320,s=I.getElementParentsAndSelf(n),c={ox:r,oy:i,tx:~~(r*a/o),ty:~~(i*a/o),xpath:I.getXPath(s)};return c}}};var C={initFlags:function(){S=r.FAIL,y=r.FAIL},initMd5:function(){b.traversal(t.body,"0_body",0,s,function(e){i+=e}),a=md5(i)},bindEvent:function(){var e=this;t.addEventListener("click",function(r){for(var i=r.target,a=i;i!=t;)i.hasAttribute("tt-data-click")&&e._sendTargetMsg(i),i=i.parentNode;if(i==t&&!o){var s={};s.target=a,s.event_type="xpath",s.page_url=decodeURIComponent(location.href),s.page_type=n,s.convert_id=m,_taq.push(s)}},!0)},getInfoFromUrl:function(){var e=w.getWebUrlInfo();return e?(d=e.req_id||"",v=e.cid||"",f=e.uid||"",l=e.ut||"",u=e.device_id||"",c=e.log_extra||"",!0):!1},initFromSessionStorage:function(){"ad"===w.getFromSessionStorage("_tt_ad_info_success")?(d=d||w.getFromSessionStorage("_tt_req_id"),v=v||w.getFromSessionStorage("_tt_cid"),m=m||w.getFromSessionStorage("_tt_convert_id"),c=c||w.getFromSessionStorage("_tt_log_extra"),S=r.UNUSE):_taq.getFromTTBridge("adInfo",function(e){var t;e=e||{},"string"==typeof e&&(e=JSON.parse(e)),v=e.cid||e.ad_id||"",t=JSON.parse(e.log_extra||"{}"),d=t.req_id||"",m=t.convert_id||"",c=e.log_extra||"{}",w.setToSessionStorage("_tt_ad_info_success","ad"),w.setToSessionStorage("_tt_cid",v),w.setToSessionStorage("_tt_req_id",d),w.setToSessionStorage("_tt_convert_id",m),w.setToSessionStorage("_tt_log_extra",c)}),"app"===w.getFromSessionStorage("_tt_app_info_success")?(u=u||w.getFromSessionStorage("_tt_device_id"),g=g||w.getFromSessionStorage("_tt_user_id"),p=p||w.getFromSessionStorage("_tt_app_version"),_=_||w.getFromSessionStorage("_tt_app_id"),y=r.UNUSE):_taq.getFromTTBridge("appInfo",function(e){e=e||{},u=e.device_id||"",g=e.user_id||"",p=e.appVersion||"",_=e.aid||"",w.setToSessionStorage("_tt_app_info_success","app"),w.setToSessionStorage("_tt_device_id",u),w.setToSessionStorage("_tt_user_id",g),w.setToSessionStorage("_tt_app_version",p),w.setToSessionStorage("_tt_app_id",_)})},_sendTargetMsg:function(t){var o={};o.page_url=decodeURIComponent(e.location.href),o.page_type=n,o.event_type=t.getAttribute("tt-data-eventtype")||"",o.convert_id=t.getAttribute("tt-data-convertid")||"",o.event_value=t.getAttribute("tt-data-eventvalue")||"",o.target=t,o.options=t.getAttribute("tt-data-options")||"",_taq.push(o)}};C.initMd5(),!C.getInfoFromUrl()&&w.isToutiao()&&C.initFromSessionStorage(),C.bindEvent()}function o(e,t){if(window.ToutiaoJSBridge)return t();var n=document.createElement("script");n.src=e,t=t||function(){},n.onload=n.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(t(),this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this))},document.getElementsByTagName("head")[0].appendChild(n)}e._taq||(e._taq=[],o("//s3.pstatp.com/inapp/toutiao.js",function(){n()}))}(window,document);